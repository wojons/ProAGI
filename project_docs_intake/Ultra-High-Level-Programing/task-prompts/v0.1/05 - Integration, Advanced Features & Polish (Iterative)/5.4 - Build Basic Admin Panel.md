## Goal: Create a Basic Web Admin Panel for Application Management

Create a simple web application (using Flask or FastAPI with Jinja2 templates) that provides a basic UI for viewing and registering UHLP applications by interacting with the `ApplicationRegistry` service.

**Context:**
*   Dependencies: `ApplicationRegistryInterface` (needs HTTP/gRPC exposure if not already), `Flask` or `FastAPI`, `Jinja2`, `httpx` (if calling API).
*   Data Models: `@core/shared/data_models.py` (`AppDefinition`)
*   Project Structure: Create a new directory, e.g., `admin_panel/`

**Plan:**

1.  **Expose `ApplicationRegistry` API (If Needed):**
    *   Ensure the `ApplicationRegistry` methods (list, get, register) are accessible via an internal HTTP API (e.g., add endpoints to the core framework server `@core/routing/request_router.py` or a dedicated API server). Define OpenAPI spec maybe.
    *   *Assumption:* Let's assume endpoints like `GET /_internal/apps`, `GET /_internal/apps/{app_id}`, `POST /_internal/apps` exist.
2.  **Create Admin Panel Directory:** Use `write_to_file` to create `admin_panel/`.
3.  **Add Dependencies:** Use `write_to_file` to create `admin_panel/requirements.txt` including `Flask` (or `FastAPI`), `Jinja2`, `httpx`. Use `execute_command` to install.
4.  **Create App Structure:** Use `write_to_file` to create:
    *   `admin_panel/app.py` (Main Flask/FastAPI application file)
    *   `admin_panel/templates/` (Directory for Jinja2 templates)
    *   `admin_panel/templates/base.html`
    *   `admin_panel/templates/app_list.html`
    *   `admin_panel/templates/app_detail.html`
    *   `admin_panel/templates/app_register.html`
5.  **Implement Flask/FastAPI App (`app.py`):**
    *   Initialize the web framework app. Configure template folder.
    *   Get the URL for the internal Core API (e.g., from environment variable `CORE_API_URL`).
    *   Initialize an `httpx.AsyncClient`.
    *   **Route: List Apps (`/`)**:
        *   Calls `GET CORE_API_URL/_internal/apps` using `httpx`.
        *   Renders `app_list.html` passing the list of app IDs.
    *   **Route: App Detail (`/apps/<app_id>`)**:
        *   Calls `GET CORE_API_URL/_internal/apps/{app_id}`.
        *   Renders `app_detail.html` passing the `AppDefinition` details. Handle errors.
    *   **Route: Register App Form (`/register`, GET)**:
        *   Renders `app_register.html` with a form (e.g., textarea for `AppDefinition` YAML).
    *   **Route: Register App Action (`/register`, POST)**:
        *   Parses the submitted YAML from the form. Validate basic structure (use `PyYAML`).
        *   Calls `POST CORE_API_URL/_internal/apps` with the parsed JSON/dict data.
        *   Handles success/error response from API. Redirects to app list or shows error message.
6.  **Create HTML Templates (`templates/*.html`):**
    *   **`base.html`:** Basic HTML structure, maybe simple navbar (links to List, Register). Defines content blocks.
    *   **`app_list.html`:** Extends `base.html`. Iterates through app IDs passed from the route, linking each to the detail page. Includes link to Register page.
    *   **`app_detail.html`:** Extends `base.html`. Displays the `AppDefinition` details (pretty-print YAML/JSON or format key fields).
    *   **`app_register.html`:** Extends `base.html`. Contains a `<form method="post">` with a `<textarea name="app_definition_yaml">` and a submit button.
7.  **Create Dockerfile (Optional):** Use `write_to_file` to create `admin_panel/Dockerfile` to containerize the admin panel app.

**Expected Outcome:**
*   A new `admin_panel/` directory containing a basic Flask/FastAPI web app.
*   HTML templates for listing, viewing details, and registering applications.
*   App interacts with the (assumed) internal API of `ApplicationRegistry`.