## Goal: Create Formal JSON Schema for Workflow YAML Definitions

Based on the specification in `05-workflow-yaml.md` [8, 21] and Section 6.1 [15, 21], create a formal JSON Schema definition file to validate the structure of UHLP Workflow YAML files.

**Context:**
*   Design Docs: `05-workflow-yaml.md` [8, 21], Section 6.1 [15, 21]
*   Schema Target Directory: `schemas/`

**Plan:**

1.  **Review Specification:** Carefully analyze `05-workflow-yaml.md` [8, 21] and Section 6.1 [15, 21] to understand all required and optional fields at the top level (`workflowId`, `description`, `trigger`, `startAt`, `steps`) and within each step definition (`type`, `target`, `inputMapping`, `outputMapping` (consider adding?), `transitions`, `onSuccess`, `onFailure`, `condition`, `end`). Include the different step `type` values (`jit`, `llm`, `mcp`, `control`) [15, 21] and subtypes (`formatResponse` for `control` [8]). Define the basic structure for `trigger` [21], `inputMapping` expressions (simple dot notation placeholder for V1), and `transitions`.
2.  **Create Schema File:** Use `write_to_file` to create `schemas/workflow_definition.schema.json`.
3.  **Define Schema Structure:** Populate the file with a valid JSON Schema structure (`$schema`, `title`, `description`, `type: object`, `properties`, `required`).
    *   **Top-Level Properties:** Define `workflowId` (string, required), `description` (string), `trigger` (object with `type` and `config`), `startAt` (string, required), `steps` (object, required).
    *   **Steps Property:** Define `steps` as an object where `additionalProperties` are the step definitions.
    *   **Step Definition Schema:** Define the schema for each step object:
        *   `type`: Enum ["jit", "llm", "mcp", "control"] (required).
        *   `description`: String (optional).
        *   `target`: String (required for jit, llm, mcp - specifies script path, prompt template path, or MCP tool name).
        *   `inputMapping`: Object (optional, allows simple mapping like `{"targetVar": "$.source.path.value"}` - define basic structure).
        *   `outputMapping`: Object (optional, consider adding for transforming step output before next step - define basic structure).
        *   `params`: Object (optional, specific overrides for `llm` or `mcp` steps).
        *   `transitions`: Object (required unless `end: true`). Define `onSuccess` (string, stepId), `onFailureDefault` (string, stepId - fallback error path), `conditionalTransitions` (array of objects with `condition` string and `nextStepId` string). Add `end`: Boolean (optional, defaults false).
    *   **Control Step Subtypes:** Use conditional schema logic (`if/then` or `oneOf`) based on `type: control` to define specific fields for subtypes like `formatResponse` (e.g., specify required fields like `resultType` and `dataMapping` for the final output).
4.  **Add Descriptions:** Add clear `description` fields to properties explaining their purpose based on the design docs.

**Expected Outcome:**
*   `schemas/workflow_definition.schema.json` containing a detailed JSON Schema for validating UHLP Workflow YAML files.