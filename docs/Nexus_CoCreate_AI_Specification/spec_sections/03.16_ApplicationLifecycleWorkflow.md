# 3.16 Application Lifecycle Workflow

This section outlines the lifecycle of an application within the Nexus CoCreate AI platform, from its initial creation (bootstrap process) to its deployment, execution, maintenance, and decommissioning, focusing on the Minimum Viable Product (MVP) / Proof of Concept (POC) functionality.

## 3.16.1 Bootstrap Process (Application Creation)

The creation and deployment of a new Nexus CoCreate AI application is initiated by a user (typically an administrator or developer) through the Admin Panel and involves several core framework components.

### 3.16.1.1 Creation – User-Friendly Initiation (MVP)

*   A prominent "+" button or "Create New Project" UI element initiates the process.
*   Users are presented with options:
    *   **"Custom Project":** Starts with a minimal boilerplate AppDefinition (placeholder name, primary prompt area, default LLM).
    *   **"Project Template" (POC Simplification):** Offers 1 or 2 simple, predefined templates (e.g., "Basic Q&A Bot," "Simple Web Page Generator").
*   Nexus prompts the user via chat for a project name and brief description.
*   Nexus may engage in a guided conversation to elicit initial requirements, with an option to skip this dialogue.

### 3.16.1.2 Application Definition Input

*   The user provides inputs (natural language description, ID/name, MCP/LLM selections, API keys, UI preferences).

### 3.16.1.3 Framework Processing (`ApplicationRegistry.RegisterApplication`)

*   Admin Panel calls `ApplicationRegistryService.RegisterApplication`.
*   A framework component translates user input into the formal `AppDefinition` structure (generating initial ComponentRegistry, Workflows, Prompts, SandboxPoolConfig, StateConfig, SecurityConfig).
*   `StateManagerInterface` initializes the application's definition state storage (local Git repo for POC).
*   `ApplicationRegistry` registers the `appId` and stores its `AppDefinition`.

### 3.16.1.4 Resource Provisioning (`SandboxManager`)

*   The `SandboxManager` is triggered by registration.
*   It calls `ApplicationRegistryService.GetSandboxRequirements`.
*   It interacts with Docker to pull images and start initial sandbox pools.

### 3.16.1.5 Application Activation

*   Once state is initialized and sandboxes are running, `ApplicationRegistry` marks the application status as `Active`.
*   The application is now ready to receive requests.

## 3.16.2 Project Storage (MVP – Local Git Focus)

A fundamental principle is that all projects are stored as Git repositories, providing version control, history, and rollback capabilities.

*   For the **MVP/POC**, these are managed as **local Git repositories** on the server.
*   `StateManagerInterface` handles all interactions (initializing, committing, reading, history).

## 3.16.3 Interaction During Design & Development (MVP)

*   Users primarily interact with Nexus via the main chat interface to provide feedback, iterate, request code/modifications, and define logic.
*   Text-based feedback and requests are sufficient for the MVP.
*   Nexus's personality can be influenced by basic user-configurable rules (simplified Cline rules concept), but project-specific rules/prompts take precedence.

## 3.16.4 App Definition (`AppDefinition`) (MVP Simplification)

The `AppDefinition` is the core specification and source of truth (YAML, managed in Git). For the MVP, it must include:
*   Unique name and internal `appId`.
*   Core prompt(s) or reference to a simple predefined workflow defining primary behavior.
*   Specific LLM model to be used.
*   AI-defined operational scripts (e.g., a "start" script command/path) for execution within Docker.

## 3.16.5 App Execution – Dockerized Sandboxes (MVP)

*   User actions ("Start," "Restart" via toolbar or chat) instruct the Core Framework to execute AI-defined operational scripts.
*   Scripts are executed within the app's dedicated **Docker container** (sandbox) for isolation and consistency.
*   `SandboxManager` orchestrates these operations (pulling images, mounting files, running scripts).
*   Apps remain active until explicitly stopped.

## 3.16.6 Stopping Apps – Clear Control & State Handling (MVP)

*   Users can stop apps via the "Stop" button or chat command.
*   UI provides clear feedback (status indicators, notifications).
*   For the POC, non-persistent runtime state within the container is discarded upon stopping. Persistent data (committed to Git, external DBs) remains.

## 3.16.7 Version Control & Rollbacks (MVP Essentials – Git Powered)

*   The Git-backed nature provides versioning and rollback.
*   Users can request rollbacks via chat (e.g., "revert the last change to 'main.py'").
*   The canvas UI for files in Git should show version history (commits, timestamps).
*   Selecting a version displays its content with an option to "Revert to this version."
*   The MVP supports rolling back a **single file** to a previous version (Nexus checks out old version, commits as new change).
*   Basic "track changes" or diff view (showing old vs. current content) is beneficial.

## 3.16.8 Deployment & Access

Once an application is bootstrapped and active:

*   **Shareable Subdomain:** The Core Framework (with ingress routing) assigns and routes traffic from a unique subdomain (e.g., `my-app.nexus.example.com`) to the specific application.
*   **Access Control:**
    *   Basic on/off switch for public accessibility via Admin Panel.
    *   Flags for restricting access during development/testing (e.g., IP whitelisting).
    *   Granular access control relies on authentication/authorization logic within the application's components/workflows, using user roles defined in `SecurityConfig`.

## 3.16.9 Updates and Maintenance

*   **Definition Updates:** Changes to application definitions, workflows, prompts, or configurations are typically made via the Admin Panel or by directly committing changes to the application's Git-based state repository. These changes are picked up by the `ApplicationRegistry` and `StateManagerInterface`.
*   **Sandbox Recycling:** The `SandboxManager` handles the recycling of unhealthy or idle sandbox instances to maintain application availability and resource efficiency.
*   **Optimization:** The `OptimizationOracle` continuously monitors performance and may trigger JIT compilation or other optimizations, updating the `ComponentRegistry` via the `StateManagerInterface`.

## 3.16.10 Decommissioning

*   **Deregistration:** An application can be deactivated or fully deregistered via the Admin Panel, invoking `ApplicationRegistryService.DeregisterApplication`.
*   **Resource Cleanup:** This signals the `SandboxManager` to terminate associated sandboxes.
*   **State Archival/Deletion:** The `DeregisterApplication` process can optionally include the deletion of the application's persistent state.
